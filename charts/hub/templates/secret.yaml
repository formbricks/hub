{{- if and .Values.secrets.create (not .Values.secrets.existingSecret) (not .Values.secrets.externalSecrets.enabled) -}}
{{- $dbUrl := required "values.secrets.stringData.DATABASE_URL is required (or set values.secrets.existingSecret)" .Values.secrets.stringData.DATABASE_URL -}}
{{- $apiKey := required "values.secrets.stringData.API_KEY is required (or set values.secrets.existingSecret)" .Values.secrets.stringData.API_KEY -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "hub.secretName" . }}
  labels:
    {{- include "hub.labels" . | nindent 4 }}
  {{- with .Values.secrets.annotations }}
  annotations:
    {{- toYaml . | nindent 4 }}
  {{- end }}
type: Opaque
stringData:
  DATABASE_URL: {{ $dbUrl | quote }}
  API_KEY: {{ $apiKey | quote }}
{{- end }}
